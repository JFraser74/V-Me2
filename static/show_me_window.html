<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>V-Me ‚Ä¢ Show Me</title>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <style>
      :root { --bg:#0b0b0c; --fg:#e9eaee; --muted:#9aa1ac; --card:#141519; --accent:#6ea8fe; }
      body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial}
      .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
      .top{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
      .brand{display:flex;gap:10px;align-items:center}
      .brand h1{font-size:20px;margin:0}
      .grid{display:grid;grid-template-columns:320px 1fr;gap:16px}
      .card{background:var(--card);border:1px solid #1f2026;border-radius:14px;padding:14px}
      .card h3{margin:.1rem 0 .6rem 0;font-size:14px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
      .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
      input,select,button,textarea{background:#0f1115;color:var(--fg);border:1px solid #232530;border-radius:10px}
      input,select,button{height:36px;padding:0 10px}
      textarea{width:100%;min-height:110px;padding:10px}
      button{cursor:pointer}
      .tabs{display:flex;gap:6px;flex-wrap:wrap}
      .tab{padding:6px 10px;border:1px solid #232530;border-radius:10px;background:#0f1115;cursor:pointer}
      .tab.active{border-color:var(--accent);box-shadow:0 0 0 1px inset var(--accent)}
      .log{white-space:pre-wrap;background:#0f1115;border:1px solid #232530;border-radius:10px;padding:10px;min-height:100px}
      .list{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;font-size:12.5px}
      .muted{color:var(--muted)}
      .pill{padding:2px 8px;border:1px solid #2a2c35;border-radius:999px;background:#11131a}
      .right{display:flex;gap:8px;align-items:center}
      .kbd{font-family:ui-monospace,monospace;padding:2px 6px;border:1px solid #2a2c35;border-radius:8px;background:#11131a}
    </style>
  </head>
  <body>
    <div class="wrap">
      <!-- Top header: logo, mic controls, global settings -->
      <header class="top" style="align-items:center">
        <div class="brand" style="align-items:center">
          <img src="/static/vme2-logo.png" alt="logo" width="36" height="36" onerror="this.style.display='none'"/>
          <h1 style="margin-left:6px">V-Me</h1>
          <span class="pill" id="session-pill">session: n/a</span>
          <span class="pill" id="langgraph-pill" style="margin-left:8px">LangGraph: unknown</span>
        </div>

        <div style="display:flex;gap:12px;align-items:center">
          <!-- Microphone controls central -->
          <div style="display:flex;gap:8px;align-items:center;margin:0 16px">
            <button id="micToggle" title="Toggle voice conversation" class="tab" style="padding:8px;border-radius:8px">üé§ Voice</button>
            <button id="meetingToggle" title="Toggle meeting mode" class="tab" style="padding:8px;border-radius:8px">üéôÔ∏è Meeting</button>
          </div>
        </div>

        <div class="right" style="position:relative">
          <button id="headerSettingsBtn" class="tab">Settings ‚öôÔ∏è</button>
          <div id="headerSettingsDropdown" style="display:none;position:absolute;right:0;top:40px;background:var(--card);border:1px solid #232530;padding:12px;border-radius:10px;width:360px;z-index:30">
            <div style="font-weight:600;margin-bottom:6px">Global Settings</div>
            <div style="font-size:13px;color:var(--muted);margin-bottom:8px">Quick access to keys & global toggles (masked values shown).</div>
            <div style="margin-bottom:8px"><label class="muted">OPENAI_API_KEY (masked)</label><input id="h_OPENAI_API_KEY" placeholder="paste key to save" style="width:100%"/></div>
            <div style="margin-bottom:8px"><label class="muted">SUPABASE_URL</label><input id="h_SUPABASE_URL" placeholder="https://..." style="width:100%"/></div>
            <div style="margin-bottom:8px"><label class="muted">SUPABASE_SERVICE_ROLE_KEY (masked)</label><input id="h_SUPABASE_SERVICE_ROLE_KEY" placeholder="paste service role key" style="width:100%"/></div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
              <button id="headerSaveSettings">Save</button>
              <button id="headerCloseSettings">Close</button>
            </div>
          </div>
        </div>
      </header>

      <div class="grid">
        <!-- Left column -->
        <div class="card">
          <h3>Controls</h3>
          <div class="row">
            <input id="label" placeholder="session label (optional)"/>
            <button id="newSessionBtn" title="Start a new session on next send">New session on send</button>
          </div>
          <div style="height:10px"></div>
          <textarea id="msg" placeholder="Type a message or slash command (e.g., /ls .)"></textarea>
          <div class="row" style="margin-top:8px">
            <button id="send">Send</button>
            <span id="status" class="muted"></span>
          </div>

          <div style="height:16px"></div>
          <h3>Settings</h3>
          <div id="settingsBanner" class="muted" style="margin-bottom:8px"></div>
          <div id="settingsBox" class="list muted">(loading ‚Ä¶)</div>
          <div style="margin-top:8px">
            <div style="margin-bottom:6px"><label class="muted">OPENAI_API_KEY (masked)</label><input id="s_OPENAI_API_KEY" placeholder="paste key to save" style="width:100%"/></div>
            <div style="margin-bottom:6px"><label class="muted">OPENAI_MODEL</label><input id="s_OPENAI_MODEL" placeholder="gpt-4o-mini" style="width:100%"/></div>
            <div style="margin-bottom:6px"><label class="muted">AGENT_TOOLS_ENABLED (comma list)</label><input id="s_AGENT_TOOLS_ENABLED" placeholder="tool1,tool2" style="width:100%"/></div>
            <div style="margin-bottom:6px"><label class="muted">SUPABASE_URL</label><input id="s_SUPABASE_URL" placeholder="https://..." style="width:100%"/></div>
            <div style="margin-bottom:6px"><label class="muted">SUPABASE_ANON_KEY (masked)</label><input id="s_SUPABASE_ANON_KEY" placeholder="paste anon key to save" style="width:100%"/></div>
            <div style="margin-bottom:6px"><label class="muted">SUPABASE_SERVICE_ROLE_KEY (masked)</label><input id="s_SUPABASE_SERVICE_ROLE_KEY" placeholder="paste service role key" style="width:100%"/></div>
            <div class="row" style="margin-top:8px">
              <label class="muted">TTS speed</label>
              <input id="ttsSpeed" type="number" step="0.1" min="0.5" max="2.0" value="1.0" style="width:88px"/>
              <label class="muted">Queue reminder (min)</label>
              <input id="queueMinutes" type="number" step="1" min="1" max="60" value="5" style="width:88px"/>
              <button id="saveSettings">Save</button>
            </div>
          </div>
          <div style="height:8px"></div>
          <div class="row">
            <label class="muted">Enable LangGraph (AGENT_USE_LANGGRAPH)</label>
            <input id="agentUseLanggraph" type="checkbox"/>
            <span id="langgraphNote" class="muted" style="margin-left:8px"></span>
          </div>
          <div class="muted" id="settingsNote" style="margin-top:6px"></div>
          <div style="height:12px"></div>
          <h3>Goals</h3>
          <div id="goalsBox" class="muted">Loading goals‚Ä¶</div>
        </div>

        <!-- Meeting overlay (hidden by default) -->
        <div id="meetingOverlay" style="display:none;position:fixed;left:0;top:64px;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:60;justify-content:center;align-items:flex-start;padding-top:40px">
          <div style="background:var(--card);border:1px solid #232530;padding:12px;border-radius:10px;margin:0 auto;width:720px;">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:700">Meeting Mode</div>
              <div><button id="endMeetingBtn">End Meeting</button></div>
            </div>
            <div style="margin-top:8px">Meeting ID: <span id="meetingId">(none)</span></div>
            <div style="margin-top:8px"><textarea id="meetingTranscript" placeholder="Transcript segments will appear here" style="height:180px;width:100%"></textarea></div>
            <div style="display:flex;gap:8px;margin-top:8px"><button id="ingestSegmentBtn">Send segment</button><button id="startMeetingBtn" style="display:none">Start Meeting</button></div>
          </div>
        </div>

        <!-- Right column -->
        <div class="card">
          <h3>Modes</h3>
          <div class="tabs" id="modes">
            <button class="tab active" data-mode="Chat">Chat</button>
            <button class="tab" data-mode="Email">Email</button>
            <button class="tab" data-mode="Coding" title="Open the Coding tab to read and edit project files (read uses /agent/read, save uses /agent/write)">Coding</button>
            <button class="tab" data-mode="Supabase">Supabase</button>
            <button class="tab" data-mode="Docs">Docs</button>
            <button class="tab" data-mode="Schedule">Schedule</button>
            <button class="tab" data-mode="Budget">Budget</button>
            <button class="tab" data-mode="PDF" title="Open the PDF tab to load a remote PDF URL or upload a local PDF file for viewing">PDF</button>
            <button class="tab" data-mode="Earth">GoogleEarth</button>
          </div>
          <div id="modePanel" class="muted" style="margin-top:10px">
            Ready. Use Chat for now; other tabs are placeholders you can wire later.
          </div>

          <!-- Per-mode header with subtle settings placeholder -->
          <div id="modeHeader" style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
            <div style="display:flex;gap:8px;align-items:center">
              <div id="modeTitle" style="font-weight:600">Chat</div>
              <div class="muted" id="modeHint" style="font-size:13px">Mode-specific controls shown here</div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <button id="modeSettingsBtn" class="tab" title="Mode settings">Mode Settings</button>
            </div>
          </div>

          <div style="height:16px"></div>
          <h3>Conversation</h3>
          <div id="log" class="log list"></div>
        </div>
      </div>
    </div>
          <div style="height:8px"></div>
          <div class="row">
            <label class="muted">Admin token (X-Admin-Token)</label>
            <input id="adminToken" placeholder="optional admin token" style="min-width:200px"/>
            <button id="rotateAdminBtn" title="Rotate admin token">Rotate</button>
            <div id="rotatedToken" class="muted" style="margin-left:8px"></div>
          </div>

    <script src="/static/show_me_window.js"></script>
  </body>
</html>
